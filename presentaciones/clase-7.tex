%\documentclass[]{beamer}
\documentclass[handout]{beamer}
%\documentclass[handout,draft]{beamer}

% Preambulo
\input{preamble.tex}

\title{Herramientas de Teledetección Cuantitativa\\{\small Clase 7}}
\author{Francisco Nemi\~na}
\institute{Unidad de Educación y Formación Masiva \\ ComisiÓn Nacional de
Actividades Espaciales}
%\institute[Inst.]{\includegraphics[height=1cm]{Figures/logosopi.png}\phantom{pepe} \includegraphics[height=1cm]{Figures/2mp.png}\phantom{pepe} \includegraphics[height=1cm]{Figures/conae.png}}
\date{}
%\titlegraphic{
%\includegraphics[height=1cm]{IMAGENES/minplan.png}\phantom{1}
%\includegraphics[height=1cm]{IMAGENES/conae.png}\phantom{1}
%\includegraphics[height=1cm]{IMAGENES/sopi.png}}

\logo{\includegraphics[height=0.7cm]{imagenes/sopi.png}}

\AtBeginSection[]
{
\begin{frame}
\frametitle{Esquema de presentación}
\tableofcontents[currentsection]
\end{frame}
}


\begin{document}
\begin{frame}
    \maketitle
\end{frame}

\section{Introducción}
\subsection{Nociones básicas}
\begin{frame}{\subsecname}
\begin{block}{Objetivo de la validación}
  Lo que esperamos es asignarle a nuestro mapa temático un cierto grado de confianza a partir de datos medidos en el terreno.
\end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{figure}
  \includegraphics[width=0.5\textwidth]{imagenes/valid.png}
  \caption{Ejemplo de datos de referencia contra un mapa temático.\footfullcite{congalton2008assessing}}
  \end{figure}
\end{frame}
%--- Next Frame ---%

\begin{frame}{\subsecname}
  \begin{figure}
  \includegraphics[width=0.4\textwidth]{imagenes/area-v.png}
  \caption{Comparación de area total.\footfullcite{congalton2008assessing}}
  \end{figure}
\end{frame}
%--- Next Frame ---%

\begin{frame}{\subsecname}
  \begin{figure}
  \includegraphics[width=0.4\textwidth]{imagenes/area-e.png}
  \caption{Comparacion de espacial.\footfullcite{congalton2008assessing}}
  \end{figure}
\end{frame}
%--- Next Frame ---%

\subsection{Matriz de confusión}
\begin{frame}{\subsecname}
\begin{block}{Definición}
  Lo que esperamos es asignarle a nuestro mapa temático un cierto grado de presición a partir de datos medidos en el terreno.
\end{block}
\end{frame}

\begin{frame}{\subsecname}
\begin{block}{Definición}
\[
\begin{bmatrix}
      & 1               & 2           &  \dots     & k      &  n_{i+}\\
    1 & n_{11}          & n_{12}      & \dots & n_{1k} &  n_{1+}\\
    2 & n_{21}          & n_{22} & \dots & n_{2k} &  n_{2+}\\
    \vdots  & \vdots & \vdots & \ddots      & \vdots         &  \ddots\\
    k & n_{k1} & n_{k2} & \dots       & n_{kk}       &  n_{k+}\\
    n_{+j} & n_{+1} & n_{+2} & \dots & n_{+k} & N
\end{bmatrix} \]
\end{block}
\end{frame}

\begin{frame}{\subsecname}
\begin{block}{Definición}
  Donde
  $$n_{i+} = \sum_j n_{ij}$$
  $$n_{+j} = \sum_i n_{ij}$$
  y donde $n$ es el número total de muestras.
\end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{exampleblock}{Ejemplo}
    Vamos a tomar sólo tres coberturas a modo de ejemplo
    \[
    \begin{bmatrix}
          & A   & S    & V  & \\
        A & 50  & 10   & 20 & 80 \\
        S & 5   & 100  & 15 & 120 \\
        V & 10  & 10   & 80 & 100 \\
          & 65  & 120  & 115& 300
    \end{bmatrix} \]
  \end{exampleblock}
\end{frame}

\begin{frame}{\subsecname}
  \begin{block}{Presición total}
    $$\frac{\sum_i n_{ii}}{n}$$
  \end{block}\pause
  \begin{block}{Presición usuario}
    $$\frac{ n_{ii}}{n_{i+}}$$
  \end{block}\pause
  \begin{block}{Presición productor}
    $$\frac{n_{jj}}{n_{+j}}$$
  \end{block}  \pause
\end{frame}

\begin{frame}{\subsecname}
  \begin{block}{Fracción de la muestra}
    $$p_{ij} = \frac{n_{ij}}{n}$$
  \end{block}\pause

  \begin{block}{Probabilidad de j en los datos de campo}
    $$p_{+j} = \sum_i p_{ij}$$
  \end{block}
  \begin{block}{Probabilidad de i en la clasificación}
    $$p_{i+} = \sum_j p_{ij}$$
  \end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{exampleblock}{Ejemplo}
    \[
    \begin{bmatrix}
          & A   & S        & V    & \\
        A & 0.17  & 0.03   & 0.07 & 0.625 \\
        S & 0.02  & 0.33   & 0.05 & 0.833 \\
        V & 0.03  & 0.03   & 0.27 & 0.800 \\
          & 0.769 & 0.833  & 0.696& 0.767
    \end{bmatrix} \]
  \end{exampleblock}
\end{frame}

\begin{frame}{\subsecname}
  \begin{block}{Matriz de confusión}
    Cualquier análisis sobre el error de una clasificación parte de la matriz de confusión.
  \end{block}
\end{frame}

\subsection{\'Indice kappa}

\begin{frame}{\subsecname}
  \begin{block}{Definición}
    El índice kappa nos permite estimar si dos matrices de confusión son distintas una de la otra o no. \pause
    \\
    Mide cuanto se acerca mi clasificación a una clasificación al azar.
  \end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{block}{Definición}
    $$\hat{K} = \frac{p_0 - p_c}{1-p_c}$$ donde
    $$p_0 = \sum_i p_{ii}$$ y $$p_c = \sum_i p_{i+}p_{+i}$$
  \end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{exampleblock}{Ejemplo}
    En este caso, $p_0 = 0.77$ \pause y $p_c = 0.35$ entonces el índice kappa nos queda $$\hat{K} = \frac{0.77-0.35}{1-0.35} = 0.64$$\pause Ahora hay que interpretar esto.
  \end{exampleblock}
\end{frame}

\begin{frame}{\subsecname}
  \begin{block}{Interpretación}
    Interpretaciones del índice kappa hay muchas. Lo mas básico es que cuanto m\'as cerca de cero este el valor, m\'as se parece la clasificacion una clasificación aleatoria.
  \end{block}
  \begin{block}{Cortes}
    \begin{figure}
      \begin{tabular}{c c c }
        0.0 - 0.4 & 0.4 - 0.8 & 0.8 - 1.0 \\
        Pobre     & Medio     & Bueno
      \end{tabular}
      \caption{Rangos de acuerdo del índice kappa \footfullcite{landis1977measurement}}
    \end{figure}
  \end{block}
\end{frame}

\subsection{Muestreo}

\begin{frame}{\subsecname}
  \begin{block}{4 preguntas}
  \begin{enumerate}
    \item ¿Qué categorías tengo?
    \item ¿Qué unidad de muestreo usar?
    \item ¿Cuántas muestras tomar?
    \item ¿Cómo elegir las muestras?
  \end{enumerate}
  \end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{block}{¿Que categorías tengo?}
    Las clases tienen que ser \pause
    \begin{itemize}[<+>]
      \item Mutualmente exclusivas
      \item Totalmente exaustivas
    \end{itemize}
    Además de tener un tamaño mínimo para ser considerado de esa clase.
  \end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{figure}
  \includegraphics[width=0.8\textwidth]{imagenes/unidad_mapa.png}
  \caption{Clases de muestreo definidas en el terreno.\footfullcite{congalton2008assessing}}
  \end{figure}
\end{frame}
%--- Next Frame ---%

\begin{frame}{\subsecname}
  \begin{block}{¿Qué unidad de muestreo usar?}
    \begin{itemize}[<+>]
      \item Un solo píxel.
      \item Un clúster de píxeles
      \item Un polígono
      \item Un clúster de polígonos
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}{Muestreo}
  \begin{block}{¿Cuántas muestras tomar?}
    $$N = \frac{B}{4b^2}$$ donde $B$ se obtiene a partir de la distribución $\chi^2$ con un grado de libertad y $b$ es la presición que uno acepta.
  \end{block}
\end{frame}

\begin{frame}{\subsecname}
  \begin{block}{¿Como elegir las muestras?}
    \begin{itemize}[<+>]
      \item Al azar.
      \item Estratificado al azar.
      \item Sistemático.
      \item Clusters
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}{Muestreo}
  \begin{alertblock}{Logistica}
    Todo lo que vimos va a estar supeditado a mi capacidad de realizar el muestreo.
  \end{alertblock}
\end{frame}

\section{Práctica}

\begin{frame}{Práctica}
  \begin{exampleblock}{Actividades prácticas de la sexta clase}
    \begin{enumerate}
      \item Abrir las imágenes clasificadas y fusionadas por el método de clasificación supervisada y no supervisada.
      \item Cargar los polígonos de validación correspondientes a cada clase.
      \item Calcular al matriz de confusión correspondiente a cada clasificación.
      \item Obtener la presición global, del usuario, productor y el índice kappa.
    \end{enumerate}
  \end{exampleblock}
\end{frame}
%--- Next Frame ---%

\section{Práctica}

\begin{frame}{Práctica}
  \begin{exampleblock}{Actividades prácticas de la sexta clase}
    \begin{enumerate}
      \item Abrir las imágenes clasificadas y fusionadas por el método de clasificación supervisada y no supervisada.
      \item Cargar los polígonos de validación correspondientes a cada clase.
      \item Calcular al matriz de confusión correspondiente a cada clasificación.
      \item Obtener la presición global, del usuario, productor y el índice kappa.
    \end{enumerate}
  \end{exampleblock}
\end{frame}
%--- Next Frame ---%

\end{document}
